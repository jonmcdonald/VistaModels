<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
 <!-- Copyright (c) 2000-2003 Quadralay Corporation.  All rights reserved. -->
 <head>
  <meta http-equiv="content-type" content="text/html">
  <meta http-equiv="charset"      content="UTF-8">
  <title>switch.htm</title>
    
    
  <script type="text/javascript" language="JavaScript1.2" src="../../../../wwhdata/common/private/title.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="../../../../wwhdata/common/private/options.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="../../../../wwhdata/common/private/locale.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="../scripts/browser.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="../scripts/strutils.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="../scripts/switch.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="../../../../wwhdata/js/document.js"></script>
  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = eval("window.self");
    window.name = "WWHFrame";
    // Create browser info object
    //
    var  WWHBrowser = new WWHBrowser_Object();
    // Create switch object
    //
    var  WWHSwitch = new WWHSwitch_Object();
//MGCRK - account for the possibility of a popup
    WWHFrame.popup = "NO";

    Parts = location.href.split("&");
    ThisLoc = location.href.toString();
    HasTopic = ThisLoc.indexOf('topic=');
    HasContext = ThisLoc.indexOf('context=');
    HasArgs = ThisLoc.indexOf('?');
    ArgSep = '?';
    
    if (Parts.length > 2)
    {
       Parameters = Parts[2].split("=");
      if (Parameters[1] == "popup")
      {
         WWHFrame.popup = "YES";
      }
    }

    ThisLocation = location.href;
    Context="";
    Topic= "";
    FirstArg = "";
    
    if (HasArgs < 0) { FirstArg = "\?context=" + GetDocumentHandle(); }
    if (HasTopic < 0) { Topic = "\&topic=" + GetFirstTopic(); }
    if ( (HasArgs > 0) && (HasContext < 0) ) { Context = "\&context=" + GetDocumentHandle(); }

//MGCRK - account for the possibility of a different first topic other than the title page (OLH projects)
//   if ( (Parts.length < 2) && (WWHFrame.popup != "YES") )
   if ( ((HasTopic < 0) || (HasContext < 0)) && (WWHFrame.popup != "YES") )
   {
      ThisLocation = location.href + FirstArg + Context + Topic ;
   }
   // -->
  </script>
 </head>

 <body onLoad="WWHSwitch.fExec(true, ThisLocation);">
 </body>
</html>
