<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.2.1385" />
    <meta name="TEMPLATEBASE" content="mgc_ww_v2.1.078" />
    <meta name="LASTUPDATED" content="Tue Nov 27 10:02:48 2012" />
    <meta name="mgc_html_doctitle" content="Vista User's Manual" />
    <title>Bus</title>
<!-- Search Engine keywords -->
    <meta name="attributes" content=" doc.type.documentation.user,doc.type.documentation.ref,product.version.v3.5,product.name.vista"/>
<!-- JavaScript Files -->
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/js/file_list.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/js/breadcrumbs.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/js/docvars.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/topics.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhelp/wwhimpl/common/scripts/popup_window.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
    <!--
      // Set reference to top level help frame
      //
      if (( window.name != "SearchTopic") && ( window.name != "PopupTopic"))
      {   var  WWHFrame = WWHGetWWHFrame(  ""); }
      else
      { var WWHFrame = eval("parent.parent"); }
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
    <!--
    var  WWHFrame = eval("parent.parent");
	document.write(MGCGetInternalStyleSheet(1));
	document.write(MGCGetDocumentStyleSheet(0));
	document.write(MGCGetPGFStyleSheet(0));
    // -->
    </script>
  </head>


<body class="body" rightmargin="25" onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">





 <script type="text/javascript" language="JavaScript1.2">
    <!--
      MGCInsertRTHeader(156);
    // -->
 </script>
 

<!--154,155,156-->
<!--EnDhEaDeR-->

<a name="MGCCIDPBus"></a>

<a name="wp16938"></a><h4 class="pHeading3">
  


Bus
  </h4>


<!--Bus-->


<a name="wp16939"></a><p class="pBody">
The <span style=" font-weight: bold;">Bus</span> model supports any number of master and slave ports and can be configured to any layering scheme, such as single layer or a multi-layer (AHB-Lite) configuration. The Bus interconnect matrix as well as other attributes are set through its parameters.
</p>


<a name="wp16940"></a><p class="pBody">
Once a Bus model is selected and the required ports assigned to it, a set of parameters are created:
</p>


<a name="wp173498"></a>
<ul><li class="LL1BulSolid">Parameters for each master port used to assign an address range to the specific peripheral:</li></ul>
<a name="wp173499"></a><ul><li class="LL2BulHollow"><span class="cReqRpl">master_port_name</span><span style=" font-family: Courier; font-weight: bold;">_</span><span class="cP12"><span style=" font-family: Courier; font-weight: bold;">base_address</span></span> (type: uint64)</li></ul>
<a name="wp173500"></a><ul><li class="LL2BulHollow"><span class="cReqRpl">master_port_name</span><span style=" font-family: Courier; font-weight: bold;">_</span><span class="cP12"><span style=" font-family: Courier; font-weight: bold;">size</span></span> (type: uint64)</li></ul>
<a name="wp16944"></a><ul><li class="LL2BulHollow"><span class="cReqRpl">master_port_name</span>_<span class="cRequired">subtract_base_address</span> (type: uint64)</li></ul>
<a name="wp137202"></a><p class="pL2Body">If <span class="cReqRpl">master_port_name</span>_<span class="cRequired">subtract_base_address</span> is set, the base address is subtracted from the address.</p>

<a name="wp142233"></a><ul><li class="LL2BulHollow"><span style=" font-weight: bold;">Default Master </span>&#151;  If there is a <span class="cReqRpl">port_name</span>_base_address parameter whose value is 0xFFFFFFFFFFFFFFFF and the payload address is not contained in any of the defined ranges (mappings) on the bus, then the payload is sent through the default master port. The default master port is generally used to build cascade busses; in which case the <span class="cReqRpl">port_name</span>_subtract_base_address parameter is set as false.</li></ul>
<a name="wp16945"></a>
<ul><li class="LL1BulSolid">Parameters for each slave port to define its priority (0 is highest):</li></ul>
<a name="wp16946"></a><ul><li class="LL2BulHollow"><span class="cReqRpl">slave_port_name</span>_<span class="cRequired">priority</span></li></ul>
<a name="wp16947"></a>
<ul><li class="LL1BulSolid">Parameters to define the bus layering (layers and slave_sets; if the parameters have default values, there is only one layer):</li></ul>
<a name="wp137138"></a><ul><li class="LL2BulHollow"><span style=" font-weight: bold;">layers</span>&#151;  Defines a <span style=" font-weight: bold;">cross bar configuration</span>. It is specified as a string describing a list of master layers separated by a semi-colon (;). Each layer is comprised of two lists separated by a colon (:) &#151;  the master side list and the slave side list. The master side list is comprised of names of master ports and optional slave ports separated by commas (,). The slave side list is comprised of names of slave ports separated by commas (,). A layer represents a group of masters and optional slaves that are connected to an interconnect matrix port, through which their associated slaves can be accessed. For example, the configuration in <a href='javascript:oT("CRF","Chapter_Customizing_Gen_Models_new03.html#wp16958");'>Figure&#160;8&#8209;1</a> is described as: &ldquo;Master1: Slave1, Slave3; Master2: Slave2, Slave3, Slave4&rdquo;; the fact that Master1 does not access Slave2 is not represented in the figure.</li></ul>



<a name="wp16958"></a><p class="pFigureTitle">
Figure 8&#8209;1. 


Cross-Bar Bus Configuration


</p>
<div align="center"><img src="images/CrossBarBus.gif" id="wp26720" border="0" hspace="0" vspace="0"/></div><p class="pFigureTitle">





</p>



<a name="wp16959"></a><ul><li class="LL2BulHollow"><span style=" font-weight: bold;">slave_sets </span>&#151;  The slaves at the slave port of an interconnect matrix can be grouped together. Accesses to these slaves are serialized: that is, at most only one can be accessed at a time. This parameter specifies a grouping of the slaves at the slave port of an interconnect matrix. It is specified a string describing a list of slave port sets separated by semi-colon (;). A slave port set is comprised of the names of slave ports separated by commas (,). </li></ul>
<a name="wp16963"></a><p class="pL2Body">For example, including both parameters, the configuration in <a href='javascript:oT("CRF","Chapter_Customizing_Gen_Models_new03.html#wp16975");'>Figure&#160;8&#8209;2</a> is described as </p>

<a name="wp137324"></a><p class="pL2Body"><span style=" font-weight: bold;">layers</span>=&ldquo;CPU1, DedicatedSram, DualPort: SharedSram, Slave1, Slave2, Slave3, Slave4; CPU2, DMA, LCDController, DualPort: SharedSram, Slave1, Slave2, Slave3, Slave4;&rdquo;</p>

<a name="wp16964"></a><p class="pL2Body"><span style=" font-weight: bold;">slave_sets</span>= &ldquo;Slave1, Slave2, Slave3, Slave4;&rdquo;</p>

<a name="wp16965"></a><p class="pL2Body">Rules for layers:</p>

<a name="wp16966"></a><ul><li class="LL3BulSolid">Every master should appear exactly once in one of the layers.</li></ul>
<a name="wp16967"></a><ul><li class="LL3BulSolid">Every slave should appear at least once in one of the layers.</li></ul>
<a name="wp16968"></a><ul><li class="LL3BulSolid">If a member of a slave set appears in a layer, all other members of the slave set should also appear in the layer.</li></ul>



<a name="wp16975"></a><p class="pFigureTitle">
Figure 8&#8209;2. 


Realistic Cross-Bar Bus Configuration


</p>
<div align="center"><img src="images/RealisticCrossBarBus.gif" id="wp26733" border="0" hspace="0" vspace="0"/></div><p class="pFigureTitle">





</p>



<a name="wp16977"></a><ul><li class="LL2BulHollow"><span class="cReqRpl">master_port_name</span>_ <span class="cRequired">vmap</span></li></ul>
<a name="wp46414"></a><p class="pL2Body">This parameter is used to enable a bus master that uses absolute addresses to access a bus where the address of the slave was changed by re-mapping a specific address range from the master. </p>

<a name="wp137345"></a><p class="pL2Body">The following example remaps 0x1000 - 0x2000 to 0x3000 - 0x4000.</p>

<a name="wp137354"></a><pre class="pCodeIndent">
              cpu_master_port_vmap &ldquo;0x1000:0x2000,0x3000;&rdquo;</pre>

<a name="wp137362"></a><pre class="pCode">              </pre>

<a name="MGCCIDPTiming And Power Policies For The Bus Model"></a>

<a name="wp46337"></a><h5 class="pHeading4">
  


Timing And Power Policies For The Bus Model
</h5>



<a name="wp46418"></a><p class="pBody">
The following <span style=" font-style: italic;">Timing</span> and <span style=" font-style: italic;">Power</span> policies are defined for the <span style=" font-weight: bold; font-style: italic;">Bus</span> model:
</p>


<a name="wp46339"></a>
<ol start="1."><li class="LL1Seq"><span class="cP12"><span style=" font-weight: bold; font-angle: normal; vertical-align: baseline; color:#000000;">Communication Power</span></span></li></ol>
<a name="wp46341"></a><p class="pL1Body">You can define <span style=" font-style: italic;">Communication Power</span> on the <span style=" font-weight: bold; font-style: italic;">Bus</span> model by using the <span style=" font-weight: bold; font-style: italic;">Delay</span> and <span style=" font-weight: bold; font-style: italic;">Split</span> policies.</p>

<a name="wp46342"></a><p class="pL1Body">Note that only the <span style=" font-style: italic;">Port/Transaction</span> and <span style=" font-style: italic;">Power</span> fields are available.</p>

<a name="wp46344"></a>
<ol start="2."><li class="LL1Seq"><span class="cP12"><span style=" font-weight: bold; font-angle: normal; vertical-align: baseline; color:#000000;">Operation Power</span></span></li></ol>
<a name="wp46346"></a><p class="pL1Body">You can define <span style=" font-style: italic;">Operation Power</span> on the <span style=" font-weight: bold; font-style: italic;">Bus </span>model by using the <span style=" font-weight: bold; font-style: italic;">Pipeline</span> policy.</p>

<a name="wp46347"></a><p class="pL1Body">The available fields for the <span style=" font-style: italic;">Pipeline</span> policy are: </p>

<a name="wp46457"></a><ul><li class="LL2BulSolid">Port/Transaction</li></ul>
<a name="wp46461"></a><ul><li class="LL2BulSolid">Cause</li></ul>
<a name="wp46462"></a><ul><li class="LL2BulSolid">Latency </li></ul>
<a name="wp46463"></a><ul><li class="LL2BulSolid">Power</li></ul>
<a name="wp46464"></a><p class="pL1Body">The latency between <span style=" font-style: italic;">slave</span> and <span style=" font-style: italic;">master</span> is calculated from the time the master got the bus (&ldquo;won&rdquo; the arbitration). The power is calculated as: </p>

<a name="wp46475"></a><p class="pL2Body">&ldquo;Defined power per word&rdquo; * &ldquo;Number of words in transaction&rdquo;.</p>

<a name="wp46476"></a><p class="pL1Body">This power is consumed along the latency interval.</p>

<br clear="all" />
<table border="0" cellpadding="0" cellspacing="0" width="80%" align="center">
  <tr valign="baseline">
    <td width="50" valign="top" background="wwhelp/wwhimpl/common/images/nbrule_upper.jpg">&#160;</td>
    <td background="wwhelp/wwhimpl/common/images/nbrule_upper.jpg"><span class="cNotesBlack">Note</span></td>
  </tr>
  <tr valign="top">
    <td width="50" valign="top"><img src="wwhelp/wwhimpl/common/images/nicon_note.jpg" /></td>
    <td valign="top">
            
<a name="wp46350"></a><p class="pnoteNote">
        	There is no <span style=" font-style: italic;">State Power Policy</span> in the <span style=" font-weight: bold; font-style: italic;">Bus</span> model.<br />&#160;
        </p>

          </td>
  </tr>
  <tr height="2">
    <td height="2" background="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg"><img src="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg" align="left" /></td>
    <td height="2" background="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg"><img src="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg" align="right" /></td>
    </tr>
 </table><a name="MGCCIDPMapping Multiple Address Ranges to a Bus Master Port"></a>

<a name="wp165962"></a><h5 class="pHeading4">
  


Mapping Multiple Address Ranges to a Bus Master Port
</h5>



<a name="wp165963"></a><p class="pBody">
To map multiple address ranges to a master port in a bus, use the <span class="cReqRpl">port_name</span>_additional_ranges parameter. 
</p>


<a name="wp165964"></a><p class="pBody">
To define the parameter value, use the following syntax:
</p>


<a name="wp165965"></a><pre class="pCode">     &quot;address_1, size_1; address_2, size_2;  &#0133; ; address_n,size_n;&quot;</pre>


<a name="wp165966"></a><pre class="pCode">     </pre>


<br clear="all" />
<table border="0" cellpadding="0" cellspacing="0" width="80%" align="center">
  <tr valign="baseline">
    <td width="50" valign="top" background="wwhelp/wwhimpl/common/images/nbrule_upper.jpg">&#160;</td>
    <td background="wwhelp/wwhimpl/common/images/nbrule_upper.jpg"><span class="cNotesBlack">Note</span></td>
  </tr>
  <tr valign="top">
    <td width="50" valign="top"><img src="wwhelp/wwhimpl/common/images/nicon_note.jpg" /></td>
    <td valign="top">
            
<a name="wp165974"></a><p class="pnoteNote">
        	When defining the parameter, the value of the parameter <span class="cReqRpl">port_name</span>_subtract_base_address should be 0. If not, a warning is issued.
        </p>

          </td>
  </tr>
  <tr height="2">
    <td height="2" background="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg"><img src="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg" align="left" /></td>
    <td height="2" background="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg"><img src="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg" align="right" /></td>
    </tr>
 </table><a name="MGCCIDPDynamic Re-mapping of a Bus"></a>

<a name="wp165975"></a><h5 class="pHeading4">
  


Dynamic Re-mapping of a Bus
</h5>



<a name="wp165976"></a><p class="pBody">
The bus has a non-TLM2.0 export with the following interface:
</p>


<a name="wp165977"></a><pre class="pCode">     void set_base_address_and_size(const char* master_port_name, <br />        uint64 address, uint64 size) ;</pre>


<a name="wp165978"></a><pre class="pCode">     bool remove_base_address(const char* portName, uint64 address);</pre>


<a name="wp165979"></a><pre class="pCode">     </pre>


<a name="wp165980"></a><p class="pBody">
Any model that should control such operations should have a port to this interface. It can have the needed registers and be a slave of the bus.
</p>


<a name="wp165984"></a><p class="pBody">
Refer to the &ldquo;<a href='javascript:oT("CRF","Chapter_Customizing_Gen_Models_new04.html");'>BusRemapper</a>&rdquo; section for more information on address re-mapping.
</p>

<a name="MGCCIDPBus Debug Port"></a>

<a name="wp166292"></a><h5 class="pHeading4">
  


Bus Debug Port
</h5>



<a name="wp166293"></a><p class="pBody">
The <span class="cReqRpl">bus_name</span>_pv class contains a default dbg_port. 
</p>


<a name="wp166294"></a><p class="pBody">
The port type is tlm::tlm_target_socket with a tlm base protocol. 
</p>


<a name="wp166351"></a><p class="pBody">
The following example shows how to use the port:
</p>


<a name="wp166296"></a><pre class="pCode">     monitor_inst = new monitor_pv(&quot;monitor_inst&quot;);</pre>


<a name="wp166297"></a><pre class="pCode">     bus_inst = new bus_pvt(&quot;bus_inst&quot;);</pre>


<a name="wp166298"></a><pre class="pCode">     monitor_inst-&gt;master(bus_inst-&gt;getPV()-&gt;get_dbg_port());</pre>


<a name="wp166299"></a><pre class="pCode">     </pre>


<a name="wp166300"></a><p class="pBody">
The model bus_inst is a Model Builder bus model and monitor_inst is a pv module. The monitor_inst model has an initiator port called &ldquo;master&rdquo; of type tlm::tlm_initiator_socket. 
</p>


<a name="wp166386"></a><p class="pBody">
The following is an example of code that could be used in a thread of the monitor:
</p>


<a name="wp166303"></a><pre class="pCode">     &#0133;</pre>


<a name="wp166304"></a><pre class="pCode">     master-&gt;b_transport(trans, t);</pre>


<a name="wp166305"></a><pre class="pCode">     &#0133;</pre>


<a name="wp166306"></a><pre class="pCode">     master-&gt;transport_dbg(trans);</pre>


<a name="wp166290"></a><pre class="pCode">     </pre>

<a name="MGCCIDPBus Error Implementation"></a>

<a name="wp158251"></a><h5 class="pHeading4">
  


Bus Error Implementation
</h5>



<a name="wp158252"></a><p class="pBody">
If you attempt to access an unmapped address, the Vista model builder BUS component returns the following TLM error status:
</p>


<a name="wp158265"></a><pre class="pCode">     tlm::TLM_ADDRESS_ERROR_RESPONSE</pre>


<a name="wp158284"></a><pre class="pCode">     </pre>


<a name="wp158266"></a><p class="pBody">
In addition an SC_WARNING is generated. The severity of this warning can be modified using the warning_level parameter described in &ldquo;<a href='javascript:oT("CRF","Chapter_Modeling_Phase17.html#wp44364");'>Auto-Generated General Parameters</a>&rdquo;. 
</p>




<script type="text/javascript" language="JavaScript1.2">
<!--
   PageTitle = "Bus";
   PDFLinkTitle = "Bus"
   ThisTopic = "BusErrorImplementation";
   CurrentFile = "Chapter_Customizing_Gen_Models_new03.html";
   MGCSetDocumentVariables();
   MGCUpdateNavPane();
      MGCInsertRTFooter();
 // -->
 </script>



  </body>
</html>
