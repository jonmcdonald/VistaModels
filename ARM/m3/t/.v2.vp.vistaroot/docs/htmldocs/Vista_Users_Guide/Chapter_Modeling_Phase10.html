<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="GENERATOR" content="Quadralay WebWorks AutoMap 2003 for FrameMaker 8.0.2.1385" />
    <meta name="TEMPLATEBASE" content="mgc_ww_v2.1.078" />
    <meta name="LASTUPDATED" content="Tue Nov 27 10:01:17 2012" />
    <meta name="mgc_html_doctitle" content="Vista User's Manual" />
    <title>Custom TLM Protocol</title>
<!-- Search Engine keywords -->
    <meta name="attributes" content=" doc.type.documentation.user,doc.type.documentation.ref,product.version.v3.5,product.name.vista"/>
<!-- JavaScript Files -->
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/js/file_list.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/js/breadcrumbs.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/js/docvars.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/topics.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhelp/wwhimpl/common/scripts/popup_window.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
    <!--
      // Set reference to top level help frame
      //
      if (( window.name != "SearchTopic") && ( window.name != "PopupTopic"))
      {   var  WWHFrame = WWHGetWWHFrame(  ""); }
      else
      { var WWHFrame = eval("parent.parent"); }
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
    <!--
    var  WWHFrame = eval("parent.parent");
	document.write(MGCGetInternalStyleSheet(1));
	document.write(MGCGetDocumentStyleSheet(0));
	document.write(MGCGetPGFStyleSheet(0));
    // -->
    </script>
  </head>


<body class="body" rightmargin="25" onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">





 <script type="text/javascript" language="JavaScript1.2">
    <!--
      MGCInsertRTHeader(105);
    // -->
 </script>
 

<!--96,104,105-->
<!--EnDhEaDeR-->

<a name="MGCCIDPCustom TLM Protocol"></a>

<a name="wp132534"></a><h4 class="pHeading3">
  


Custom TLM Protocol
  </h4>


<!--CustomTLMProtocol-->


<a name="wp132536"></a><p class="pBody">
You can create Protocols with channels. 
</p>


<a name="wp132563"></a><p class="pBody">
A (hardware) channel links an initiator to a target. Information routing in the channel is controlled through a specific handshake procedure. A protocol with multi-channels can transmit data in parallel.
</p>


<a name="wp132542"></a><p class="pBody">
For example, in AHB there are two channels: Address and Data. An AHB transaction is transmitted in the following order: (1) the address phase is transmitted and (2) the data phase is transmitted. Because the protocol uses parallelism, the next transaction address phase is transmitted while the previous transaction data phase is transmitted.
</p>


<a name="wp132544"></a><p class="pBody">
In each channel an operation should be initiated (in the address phase it must be the master who initiates by issuing an address-request). In AHB, the data phase is also initiated by the Master (by issuing a data-request). 
</p>


<a name="wp132604"></a><p class="pBody">
In TLM protocols, phases are used to specify timing points for the protocol handshake procedure. Each phase is defined at two timing points (begin and end): Begin_Request and End_Request.
</p>


<a name="wp132632"></a><p class="pBody">
The TCL commands and options that can be used to define a new TLM protocol are listed under <a href='javascript:oT("CRF","Chapter_Modeling_Phase10.html#wp132550");'>Custom TLM Protocol Commands and Options</a>. Knowledge of both TLM2.0 Base-Protocol and Vista basic modeling methodology are assumed.
</p>

<a name="MGCCIDPCustom TLM Protocol Commands and Options"></a>

<a name="wp132550"></a><h5 class="pHeading4">
  


Custom TLM Protocol Commands and Options
</h5>



<a name="wp132654"></a><p class="pBody">
The command for creating a protocol using a tcl script is:
</p>


<a name="wp132652"></a><p class="pzUsage">
create_protocol <span class="cReqRpl">protocol-tcl-script</span> [-g | -generate-ipxact] <br />[{-i | ipxact-dest-library} <span class="cOptRpl">ipxact-dest-library</span>] [{-v | -vendor} <span class="cOptRpl">ipxact-vendor</span>] <br />[{-ver | -version} <span class="cOptRpl">ipxact-version</span>]
</p>


<a name="wp135731"></a><p class="pBody">
For information on the command arguments, see &ldquo;<a href='javascript:oT("CRF","Chapter_Command_Line_Ops_mb12.html");'>create_protocol</a>&rdquo;. If there is an error in the protocol script, an error message is displayed and the protocol is not be created. 
</p>


<a name="wp132696"></a><p class="pBody">
The TCL commands and options that can be used in the script to define a new TLM protocol are:
</p>


<a name="wp132700"></a><p class="pzUsage">
<span class="cRequired">set_protocol_name</span> <span class="cReqRpl">name</span> 
</p>


<a name="wp133041"></a><p class="pzShortDesc">
Specifies the protocol name. 
</p>


<a name="wp132706"></a><p class="pzUsage">
<span class="cRequired">set_protocol_type</span> <span class="cReqRpl">type</span> 
</p>


<a name="wp133045"></a><p class="pzShortDesc">
Specifies the protocol type. The type can be bus, stream or signal (not case-sensitive). 
</p>


<a name="wp139973"></a><p class="pzptArg1">
<span class="cRequired">Bus</span> &#151;  A memory mapped bus where each read and write operation has an address attribute and data attribute. The address attribute enables one master to many slaves communication. A bus generic model can be generated for a protocol of the type <span class="cRequired">bus</span>. 
</p>


<a name="wp139974"></a><p class="pzptArg1">
Stream &#151;  A point-to-point streaming protocol that has only a write transaction without the address attribute. The stream protocol can inherently have a handshake mechanism that ensures no data loss.
</p>


<a name="wp140009"></a><p class="pzptArg1">
Signal &#151;  A signal protocol that provides no handshake point-to-point write transactions without the address attribute. Each value change of the signal is a zero time write transaction. Unlike an HDL signal, a signal protocol needs a splitter generic model to have fan-out.
</p>


<a name="wp140010"></a><p class="pzBody">
If not specified, type is set to bus. 
</p>


<a name="wp132712"></a><p class="pzUsage">
<span class="cRequired">set_external_trait_class</span> <span class="cReqRpl">trait_class</span> 
</p>


<a name="wp133049"></a><p class="pzShortDesc">
Defines the name of an existing trait_class. If non-ignorable extensions are used in a protocol, you should define a trait class to prevent binding the protocol ports with other protocol ports.
</p>


<a name="wp132718"></a><p class="pzUsage">
<span class="cRequired">set_external_include</span> <span class="cReqRpl">include_path</span> 
</p>


<a name="wp133053"></a><p class="pzShortDesc">
Specifies the .<span style=" font-style: italic;">h</span> file that includes the external trait class for the protocol.
</p>


<br clear="all" />
<table border="0" cellpadding="0" cellspacing="0" width="80%" align="center">
  <tr valign="baseline">
    <td width="50" valign="top" background="wwhelp/wwhimpl/common/images/nbrule_upper.jpg">&#160;</td>
    <td background="wwhelp/wwhimpl/common/images/nbrule_upper.jpg"><span class="cNotesBlack">Note</span></td>
  </tr>
  <tr valign="top">
    <td width="50" valign="top"><img src="wwhelp/wwhimpl/common/images/nicon_note.jpg" /></td>
    <td valign="top">
            
<a name="wp139855"></a><p class="pnoteNote">
        	External trait class is currently not supported when a protocol has parameters (add_parameter).
        </p>

          </td>
  </tr>
  <tr height="2">
    <td height="2" background="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg"><img src="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg" align="left" /></td>
    <td height="2" background="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg"><img src="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg" align="right" /></td>
    </tr>
 </table>
<a name="wp132724"></a><p class="pzUsage">
<span class="cRequired">add_transaction</span> <span class="cReqRpl">type</span> <span class="cReqRpl">content_script</span> 
</p>


<a name="wp133057"></a><p class="pzShortDesc">
Defines the name and prototype of the protocol read and write functions that are generated in the PV model both as port callbacks and as the read and write convenience layers. 
</p>



<a name="wp132958"></a><div class="LLzArgDesc">Parameters:</div>
<a name="wp132962"></a><p class="pzptArg1">
<span class="cReqRpl">type</span> &#151;  READ or WRITE (not case sensitive)
</p>


<a name="wp132953"></a><p class="pzptArg1">
<span class="cReqRpl">content_script</span> &#151;  the TCL commands describing the transaction parameters that carry values that are not part of the standard TLM2.0 generic payload; for example, lock or priority (see &ldquo;<a href='javascript:oT("CRF","Chapter_Modeling_Phase10.html#wp132839");'>add_transaction Script</a>&rdquo;). 
</p>

<a name="MGCCIDPadd_transaction Script"></a>

<a name="wp132839"></a><h5 class="pHeading4">
  


add_transaction Script
</h5>



<a name="wp132840"></a><p class="pBody">
The add_transaction script can contain the following parameters:
</p>


<a name="wp132841"></a><p class="pzUsage">
<span style=" font-weight: bold;">add_parameter</span> <span class="cReqRpl">data_type parameter_name</span> [-reference | -r]
</p>



<a name="wp132843"></a><div class="LLzArgDesc">Parameters:</div>
<a name="wp132847"></a><p class="pzptArg1">
data_type &#151;  parameter type
</p>


<a name="wp132849"></a><p class="pzptArg1">
parameter_name &#151;  string, parameter name
</p>


<a name="wp139884"></a><p class="pzptArg1">
-reference | -r] &#151;  passes the parameter by reference, by default parameter is passed by value
</p>


<a name="wp132855"></a><p class="pzUsage">
<span class="cRequired">add_channel</span> [-data-channel | -d] [{-start-phase-name | -start} <span class="cOptRpl">start_phase_name</span>] <br />[{-end-phase-name | -end} <span class="cOptRpl">end_phase_name</span>] [-initiated-by-slave | -i] <span class="cReqRpl">name</span>
</p>



<a name="wp132857"></a><div class="LLzArgDesc">Parameters:</div>
<a name="wp132859"></a><p class="pzptArg1">
name - channel name
</p>


<a name="wp132861"></a><p class="pzptArg1">
-data-channel | -d &#151;  indicates that the channel is the data channel
</p>


<a name="wp132863"></a><p class="pzptArg1">
{-start-phase-name | -start} <span class="cOptRpl">start_phase_name</span> &#151;  first phase of the channel
</p>


<a name="wp132865"></a><p class="pzptArg1">
{-end-phase-name | -end} <span class="cOptRpl">end_phase_name</span> &#151;  end phase of the channel
</p>


<a name="wp135778"></a><p class="pzptArg1Body">
The start and end phase names are checked, and if a name is not supported, an error is issued and the protocol is not created.
</p>


<a name="wp135779"></a><p class="pzptArg1Body">
The phase names are not case sensitive. 
</p>


<a name="wp135780"></a><p class="pzptArg1Body">
For a single channel, the start name should be BEGIN_REQ and the end name should be BEGIN_RESP. 
</p>


<a name="wp135822"></a><p class="pzptArg1Body">
For more than one channel: 
</p>


<a name="wp135829"></a><p class="pzptArg2Body">
First channel start name should be BEGIN_REQ and the end name should be END_REQ.
</p>


<a name="wp135830"></a><p class="pzptArg2Body">
Last channel start name should be BEGIN_RESP and the end name should be END_RESP
</p>


<a name="wp139895"></a><p class="pzptArg2Body">
Any middle channel should have a different phase name than the ones specified for the first and last channel.
</p>


<br clear="all" />
<table border="0" cellpadding="0" cellspacing="0" width="80%" align="center">
  <tr valign="baseline">
    <td width="50" valign="top" background="wwhelp/wwhimpl/common/images/nbrule_upper.jpg">&#160;</td>
    <td background="wwhelp/wwhimpl/common/images/nbrule_upper.jpg"><span class="cNotesBlack">Note</span></td>
  </tr>
  <tr valign="top">
    <td width="50" valign="top"><img src="wwhelp/wwhimpl/common/images/nicon_note.jpg" /></td>
    <td valign="top">
            
<a name="wp132867"></a><p class="pnoteNote">
        	A channel might or might not have phases; if not, it will not consume simulation time (for example: AXI Write-Response); the address and data channels must be associated with phases.<br />For single or first and last channels, if phases are not specified, they are set by default to: BEGIN_REQ, BEGIN_RESP (single channel): BEGIN_REQ, END_REQ (first channel); and BEGIN_RESP, END_RESP (last channel).
        </p>

          </td>
  </tr>
  <tr height="2">
    <td height="2" background="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg"><img src="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg" align="left" /></td>
    <td height="2" background="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg"><img src="wwhelp/wwhimpl/common/images/nbrule_bottom.jpg" align="right" /></td>
    </tr>
 </table>
<a name="wp132869"></a><p class="pzptArg1">
-initiated-by-slave | -i &#151;  Use when the activity in the channel is not initiated by a master but by the slave
</p>


<a name="wp132873"></a><p class="pzUsage">
<span class="cRequired">associate_channels_to_transaction</span> <span class="cReqRpl">transaction_type</span> <span class="cReqRpl">channel_list</span>
</p>


<a name="wp135755"></a><p class="pBody">
The association to a transaction is in accordance with the transaction type. Both the transaction and the channel must be declared; it is not possible to associate a transaction or a channel that was not declared.
</p>



<a name="wp132875"></a><div class="LLzArgDesc">Parameters:</div>
<a name="wp132877"></a><p class="pzptArg1">
<span class="cReqRpl">transaction_type</span> &#151;  transaction type to which channels are associated. The transaction type can be READ or WRITE (not case sensitive).
</p>


<a name="wp132879"></a><p class="pzptArg1">
<span class="cReqRpl">channel_list</span> &#151;  list of channel names that are associated with the specified transaction name
</p>


<a name="wp133326"></a><p class="pzptArg1Body">
The order of the channels in the list is the order in which the channels are activated by the transaction. Currently a channel can not have different successors in different transactions.
</p>

<a name="MGCCIDPProtocol Example: axi_test"></a>

<a name="wp133348"></a><h5 class="pHeading4">
  


Protocol Example: axi_test
</h5>



<a name="wp133350"></a><pre class="pCode">     set_protocol_name &quot;axi_test&quot;</pre>


<a name="wp133352"></a><pre class="pCode">     set_protocol_type &quot;bus&quot;</pre>


<a name="wp133354"></a><pre class="pCode">     add_channel write_address -start begin_req -end end_req</pre>


<a name="wp133356"></a><pre class="pCode">     add_channel write_data -start begin_resp -end end_resp -data_channel <br />        -initiated_by_slave</pre>


<a name="wp133358"></a><pre class="pCode">     add_channel write_response -initiated_by_slave</pre>


<a name="wp133360"></a><pre class="pCode">     add_channel read_addres -start begin_req -end end_req</pre>


<a name="wp133362"></a><pre class="pCode">     add_channel read_data -start begin_resp -end end_resp -data_channel <br />        -initiated_by_slave</pre>


<a name="wp133364"></a><pre class="pCode">     add_transaction WRITE {</pre>


<a name="wp133366"></a><pre class="pCode">        add_parameter int priority</pre>


<a name="wp133368"></a><pre class="pCode">        add_parameter int lock</pre>


<a name="wp133370"></a><pre class="pCode">     }</pre>


<a name="wp133372"></a><pre class="pCode">     add_transaction READ {</pre>


<a name="wp133374"></a><pre class="pCode">        add_parameter int priority</pre>


<a name="wp133376"></a><pre class="pCode">        add_parameter int lock</pre>


<a name="wp133378"></a><pre class="pCode">     }</pre>


<a name="wp133380"></a><pre class="pCode">     associate_channels_to_transaction READ {read_addres read_data}</pre>


<a name="wp133382"></a><pre class="pCode">     associate_channels_to_transaction WRITE {write_address write_data </pre>


<a name="wp133444"></a><pre class="pCode">        write_response}</pre>




<script type="text/javascript" language="JavaScript1.2">
<!--
   PageTitle = "Custom TLM Protocol";
   PDFLinkTitle = "Custom.TLM.Protocol"
   ThisTopic = "ProtocolExampleaxitest";
   CurrentFile = "Chapter_Modeling_Phase10.html";
   MGCSetDocumentVariables();
   MGCUpdateNavPane();
      MGCInsertRTFooter();
 // -->
 </script>



  </body>
</html>
